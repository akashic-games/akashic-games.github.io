import{_ as a,c as e,o as i,a3 as s}from"./chunks/framework.B_s5ISUx.js";const E=JSON.parse('{"title":"ECMAScript のバージョン (JavaScript で利用できる機能) について","description":"","frontmatter":{},"headers":[],"relativePath":"shin-ichiba/es-version.md","filePath":"shin-ichiba/es-version.md"}'),t={name:"shin-ichiba/es-version.md"},c=s('<h1 id="ecmascript-のバージョン-javascript-で利用できる機能-について" tabindex="-1">ECMAScript のバージョン (JavaScript で利用できる機能) について <a class="header-anchor" href="#ecmascript-のバージョン-javascript-で利用できる機能-について" aria-label="Permalink to &quot;ECMAScript のバージョン (JavaScript で利用できる機能) について&quot;">​</a></h1><h2 id="abstract" tabindex="-1">要約 <a class="header-anchor" href="#abstract" aria-label="Permalink to &quot;要約 {#abstract}&quot;">​</a></h2><ul><li>ニコ生ゲームにおいて <strong>ES2016 以降の機能は利用しないでください</strong> (2024 年 9 月現在)。</li><li>TypeScript では、<code>target</code> を指定することで ES2016 以降でも利用できる機能があります。</li></ul><h2 id="es-versions" tabindex="-1">ECMAScript のバージョンと動作環境問題 <a class="header-anchor" href="#es-versions" aria-label="Permalink to &quot;ECMAScript のバージョンと動作環境問題 {#es-versions}&quot;">​</a></h2><p>JavaScript の構文や組み込みの機能は、<a href="https://262.ecma-international.org/" target="_blank" rel="noreferrer">ECMAScript</a> (ECMA-262) として規格化されています。 規格は毎年更新されていて、新しい版ほど高機能になります。</p><p>たとえば <code>const</code>, <code>let</code> やアロー関数、 <code>Map</code> と <code>Set</code> などは 2015 年の版 (ES2015) で追加された機能です。 同様に、冪乗演算子 <code>**</code> は 2016 年の版 (ES2016)、 <code>async</code> 関数は 2017 年、optional chaining 演算子 <code>?.</code> は 2020 年の版で追加されました。</p><p>新しい版の機能は便利なことも多い一方、 <strong>実行環境によってはサポートされていない</strong> 可能性があります。 サポートされていない機能を利用すると、プログラムは単にエラーになり、続行できません。</p><p>特に演算子や構文がサポートされていない場合、プログラムは一行も実行されることなくエラーになるため 「ゲーム画面にエラーメッセージを表示してプレイヤーにソフトウェア更新を促す」といった対応すらできません。</p><h2 id="es-on-namagame" tabindex="-1">ニコ生ゲームのサポート範囲 <a class="header-anchor" href="#es-on-namagame" aria-label="Permalink to &quot;ニコ生ゲームのサポート範囲 {#es-on-namagame}&quot;">​</a></h2><p>この問題を避けるため、 <strong>ニコ生ゲームでは現在、ES2015 までの機能をサポート範囲</strong> としています。 2024 年 9 月現在、ES2016 以降の機能の利用は避けるようにしてください。</p><p>避けるべき機能の例:</p><ul><li><code>**</code>, <code>?.</code>, <code>??</code>, <code>&amp;&amp;=</code>, <code>||=</code> などの演算子</li><li>オブジェクト内の <code>...</code></li><li>変数束縛なしの <code>catch</code> 節</li><li>配列の <code>flat()</code>, <code>flatMap()</code>, <code>at()</code></li><li>文字列の <code>padStart()</code>, <code>padEnd()</code>, <code>matchAll()</code></li><li><code>BigInt</code>, <code>WeakRef</code></li></ul><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>これらは一例です。「ES2016 以降」に該当する機能の具体的な内容については、 Ecma TC39 の <a href="https://github.com/tc39/proposals/blob/main/finished-proposals.md" target="_blank" rel="noreferrer">Finished Proposals</a> などを参照してください。 このページは 2016 年以降の版に含められた仕様の一覧になっているので、書かれているものは全て ES2016 以降に当てはまります。</p></div><p>後述のとおり、<strong>この制限は TypeScript では一部緩和されます</strong> 。 より新しい機能を使いたい場合は TypeScript テンプレートの利用を検討してください。</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>ニコ生ゲームのこの制限は、主にニコニコ生放送がサポートする古い機種のスマートフォンによって生じています。 将来的に Android などのサポート状況が変化した場合、この制限は緩和されます。</p></div><h2 id="typescript-target" tabindex="-1">TypeScript で開発している場合 <a class="header-anchor" href="#typescript-target" aria-label="Permalink to &quot;TypeScript で開発している場合 {#typescript-target}&quot;">​</a></h2><p>TypeScript では、.js ファイルを生成する際の ECMAScript のバージョンを指定することができます (tsconfig.json の <a href="https://www.typescriptlang.org/tsconfig/#target" target="_blank" rel="noreferrer"><code>&quot;target&quot;</code></a> プロパティ) 。</p><p>Akashic Engine の TypeScript テンプレートには最初からこの設定が含まれています。 そのため構文や演算子に関しては ES2016 以降の機能を利用できます。 たとえば (ES2020 で追加された) <code>??</code> 演算子を利用する以下のコードは、</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">??</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>ES2015 までの機能だけを使う等価なコードとして以下の内容が .js ファイルに出力されます。</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!==</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>この <strong>TypeScript による変換は構文や演算子に限られます</strong> 。クラスやオブジェクトのメソッドなどには対応していません。 たとえば以下のものは TypeScript テンプレートであっても利用できません。</p><ul><li>配列の <code>flat()</code>, <code>flatMap()</code>, <code>at()</code></li><li>文字列の <code>padStart()</code>, <code>padEnd()</code>, <code>trimStart()</code>, <code>trimEnd()</code>, <code>matchAll()</code></li><li><code>BigInt</code>, <code>WeakRef</code> など</li></ul><p>TypeScript テンプレートでは、これらの機能を利用するとエラーになるようになっています。</p></div>',22),o=[c];function p(r,d,l,n,h,k){return i(),e("div",null,o)}const m=a(t,[["render",p]]);export{E as __pageData,m as default};
