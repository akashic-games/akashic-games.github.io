import{_ as a}from"./chunks/cli-serve-playback-tool.MPqGTj1r.js";import{_ as n,c as t,I as h,a3 as s,o as e,E as l}from"./chunks/framework.B_s5ISUx.js";const p="/assets/aimgui-sample.CTeVZryR.gif",v=JSON.parse('{"title":"更新情報 (〜2021/12/24)","description":"","frontmatter":{},"headers":[],"relativePath":"recent-changes/2021/202112.md","filePath":"recent-changes/2021/202112.md"}'),k={name:"recent-changes/2021/202112.md"},r=s('<h1 id="更新情報-〜2021-12-24" tabindex="-1">更新情報 (〜2021/12/24) <a class="header-anchor" href="#更新情報-〜2021-12-24" aria-label="Permalink to &quot;更新情報 (〜2021/12/24)&quot;">​</a></h1><h2 id="aimgui" tabindex="-1">GUI ライブラリ AimGui を公開 <a class="header-anchor" href="#aimgui" aria-label="Permalink to &quot;GUI ライブラリ AimGui を公開 {#aimgui}&quot;">​</a></h2><p>Akashic Engine 用のシンプルな GUI ライブラリ AimGui を公開しました。</p><p>ラベル、ボタン、ラジオボタン、チェックボックス、スライダー、テキストボックスなどに加え、 リサイズ可能なウィンドウ、モーダルウィンドウなどを手軽に作成することができます。 たとえば次のような UI を、</p><p><img src="'+p+`" alt="AimGui サンプル"></p><p>以下のコードで実現できます。</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> guiE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> aimgui.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">GuiE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  scene,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  width: g.game.width,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  height: g.game.height,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  font</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">scene.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">append</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(guiE);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// GUIで操作するデータ。</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> gameSetting</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  volume: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// GUIの配置と応答の実装。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">guiE.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">run</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">gui</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  gui</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">window</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Debug Tool&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ウインドウを配置。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">position</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 初期位置の指定。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">240</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">240</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 初期サイズの指定。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">show</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">gui</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // 表示。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // ラベルの表示。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      gui.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">label</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;サウンドテスト&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // ボリュームを変更するスライダー。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      gui.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">slider</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ボリューム&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, gameSetting, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;volume&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // 音声を再生するボタン。</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (gui.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">button</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;再生&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        scene.asset</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getAudio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/audio/se&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">play</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">changeVolume</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(gameSetting.volume);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><p>詳細な利用方法は以下を参照してください:</p><ul><li><a href="https://akashic-games.github.io/demo/?title=aimgui" target="_blank" rel="noreferrer">サンプルデモ</a></li><li><a href="https://github.com/akashic-games/aimgui/tree/main/sample" target="_blank" rel="noreferrer">サンプルデモのサンプルコード</a></li><li><a href="https://akashic-games.github.io/aimgui/api/" target="_blank" rel="noreferrer">API リファレンス</a></li></ul><h2 id="svg" tabindex="-1">SVG ファイルをアセットとして利用できるように (実験的機能追加) <a class="header-anchor" href="#svg" aria-label="Permalink to &quot;SVG ファイルをアセットとして利用できるように (実験的機能追加) {#svg}&quot;">​</a></h2><p>Akashic Engine v3.2.0 以降では、新たに SVG ファイルを画像アセットとして利用できます。 SVG ファイルを利用することで、PNG ファイルではぼやけてしまう画像の拡大描画を行うことができます。 また今まで Akashic Engine で表現することが難しかった円や曲線などを手軽に描画することが可能になります。</p><p>以下は、 <strong>画面をドラッグするとそのサイズの円を置く</strong> コンテンツです。</p>`,12),E=s(`<p>SVG ファイルを利用するには、ゲームの <code>image/</code> フォルダまたは <code>assets/</code> フォルダに拡張子 .svg のファイルを置き、 <code>akashic scan asset</code> を実行します。 すると他のアセット同様 game.json に登録されます。</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;circle&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;vector-image&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;width&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;height&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;path&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;image/circle.svg&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>SVG ファイルを使うベクタ画像アセットは、そのままでは <code>g.Sprite</code> などに利用できません。 <code>createSurface()</code> でサーフェス (<code>g.Surface</code>) に変換 (ラスタライズ) する必要があります。</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> asset </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> scene.asset.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getVectorImage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;image/circle.svg&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> surface </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> asset.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createSurface</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// SVG 画像を 200x200 のサーフェスにラスタライズ</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">surface) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // ! SVG が利用できない場合のフォールバック対応</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sprite </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> g.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Surface</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  scene: scene,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  src: surface </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// g.Sprite のソース画像として利用</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><p>ゲーム開発者自身が生成した <code>g.Surface</code> はエンジンによるリソース開放処理が行われません。 描画用メモリの枯渇を防ぐためにも、適切なタイミングで <code>g.Surface</code> を開放してください。 また、現時点では上の例のように <code>createSurface()</code> が <code>null</code> を返す状況を考慮する必要があります (ブラウザ環境以外での実行時に失敗することがあるため。&quot;ranking&quot; 形式以外のニコ生ゲームにも当てはまります) 。 詳細は逆引きリファレンスの <a href="https://akashic-games.github.io/reverse-reference/v3/asset/svg-asset.html" target="_blank" rel="noreferrer">SVG ファイルを画像アセットとして利用する</a> を参照してください。</p><h2 id="snapshot" tabindex="-1">マルチプレイへの途中参加時などの &quot;早送り&quot; 処理を短縮できるように <a class="header-anchor" href="#snapshot" aria-label="Permalink to &quot;マルチプレイへの途中参加時などの &quot;早送り&quot; 処理を短縮できるように {#snapshot}&quot;">​</a></h2><p>Akashic Engine は、ゲームプレイ中に行われた全操作を原則全プレイヤーに共有します。 この動作によって、細かな通信を意識することなく手軽にマルチプレイゲームを作成することが可能です (参考: <a href="https://akashic-games.github.io/tutorial/v3/multiplay/introduction.html#architecture-intro" target="_blank" rel="noreferrer">Akashic におけるマルチプレイ</a>)。</p><p>ただしこの動作には「長時間起動されるゲームに弱い」という弱点があります。 プレイ中のゲームに途中から参加する場合、まず「それまでに行われた全操作」を早送りで実行して、ゲームの最新状態に追いつかなくてはならないためです。 一度の起動でメインゲーム部分を繰り返し遊ぶなど、長時間起動されるゲームでは、この早送りの時間が長くなります。</p><p>Akashic Engine v3.2.2 以降 では、この早送り時間を短縮するために <strong>スナップショット</strong> 機能が追加されています。 一プレイ内で繰り返し遊ぶメインゲーム部分がちょうど終わった時などに、 区切りのいいタイミングで <code>g.game.requestSaveSnapshot()</code> を呼び出してスナップショットを保存することができます。</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">g.game.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">requestSaveSnapshot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // その時のゲームの実行状態を表す &quot;スナップショット&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> snapshot </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    highscore: g.game.vars.highscore </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 例: そのプレイ中に繰り返し遊んだ中で最も高かったスコア情報</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  };</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> snapshot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><p>保存されたスナップショットは、必要に応じて自動的に取得され、ゲーム起動時に与えられます。 ゲーム開発者はスナップショットが与えられた時に、保存時のゲーム状態を再現してください。</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">param</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (param.snapshot) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 過去に保存したスナップショットが与えられたので、そこから保存時の状態 (シーンなど) を作る</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // スナップショットが与えられていないので従来どおりの起動。起動時のシーンなどを作る。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>併せて akashic-cli@2.14.14 以降では、スナップショットの動作を確認するための機能が追加されています。 詳細はチュートリアルの <a href="https://akashic-games.github.io/tutorial/v3/multiplay/snapshot.html" target="_blank" rel="noreferrer">早送り時間を短縮する</a> を参照してください。</p><p><img src="`+a+'" alt="serve の Playback ツール"></p><h2 id="init-github" tabindex="-1">akashic init で Git リポジトリからテンプレートを取得できるように <a class="header-anchor" href="#init-github" aria-label="Permalink to &quot;akashic init で Git リポジトリからテンプレートを取得できるように {#init-github}&quot;">​</a></h2><p><code>akashic init</code> コマンドでは、<code>-t</code> オプションで利用するテンプレートを指定できます。 テンプレートの一覧は <code>akashic init -l</code> で確認することができます。</p><p>akashic-cli@2.11.5 以降では、これに加えて任意の Github のリポジトリの内容をテンプレートとして利用できます (<code>git</code> コマンドがインストールされている必要があります)。 以下は <a href="https://github.com/akashic-contents/niconicoSnake" target="_blank" rel="noreferrer">https://github.com/akashic-contents/niconicoSnake</a> の内容を取得する利用例です。</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">akashic</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> init</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> github:akashic-contents/niconicoSnake</span></span></code></pre></div><p><code>-t</code> オプションに <code>github:&lt;owner&gt;/&lt;repository&gt;</code> と指定することによって、 <code>https://github.com/&lt;owner&gt;/&lt;repository&gt;</code> のリポジトリをそのまま取得します。 自作のテンプレートを Github で公開している場合などに利用できます。 また、 <code>ghe:&lt;owner&gt;/&lt;repository&gt;</code> で GitHub Enterprise のリポジトリの内容を取得することも可能です (<code>@akashic/akashic-cli@2.12.0</code> 以降)。</p><p>なおこの機能では任意の Github リポジトリを指定できるため、Akashic コンテンツでないものや、最悪の場合悪意のあるスクリプトなども取得する恐れがあります。 そのため自作のテンプレートを置いたリポジトリや信頼できるリポジトリのみ使うようにしてください。</p><p>関連 PR:</p><ul><li><a href="https://github.com/akashic-games/akashic-cli/pull/869" target="_blank" rel="noreferrer">https://github.com/akashic-games/akashic-cli/pull/869</a></li><li><a href="https://github.com/akashic-games/akashic-cli/pull/881" target="_blank" rel="noreferrer">https://github.com/akashic-games/akashic-cli/pull/881</a></li></ul><h2 id="bugfixes" tabindex="-1">主な不具合修正 <a class="header-anchor" href="#bugfixes" aria-label="Permalink to &quot;主な不具合修正 {#bugfixes}&quot;">​</a></h2><h3 id="nicolive-missed" tabindex="-1">game.json の environment.nicolive の一部の指定が無視されていた問題を修正 <a class="header-anchor" href="#nicolive-missed" aria-label="Permalink to &quot;game.json の environment.nicolive の一部の指定が無視されていた問題を修正 {#nicolive-missed}&quot;">​</a></h3><p>ニコ生ゲームの設定を記述するプロパティ <code>environment.nicolive</code> のうち、 <code>preferredSessionParameters</code> の値が無視されていました。 この値は現在のところ、ランキングモードの制限時間を指定する以下のプロパティでのみ利用されています。</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">environment.nicolive.preferredSessionParameters.totalTimeLimit;</span></span></code></pre></div><p>この設定が無視され、常にデフォルトの制限時間で起動されていました。 この不具合は、2021/11/30 に修正済みです。</p><h3 id="cli-install-failure" tabindex="-1">npm@7.13.0 以前の npm で、 akashic-cli のインストールに失敗する不具合の修正 <a class="header-anchor" href="#cli-install-failure" aria-label="Permalink to &quot;npm\\@7.13.0 以前の npm で、 akashic-cli のインストールに失敗する不具合の修正 {#cli-install-failure}&quot;">​</a></h3><p>v7.13.0 以前の npm において、 v2.12.0 以前の akashic-cli のインストールに失敗する問題があります。</p><p>この不具合は、 akashic-cli@2.12.1 で修正済みです。</p><h3 id="export-wrong-warn" tabindex="-1">akashic export html で誤った警告が表示される不具合の修正 <a class="header-anchor" href="#export-wrong-warn" aria-label="Permalink to &quot;akashic export html で誤った警告が表示される不具合の修正 {#export-wrong-warn}&quot;">​</a></h3><p>akashic-cli@2.13.1 以前のバージョンで <code>akashic export html --atsumaru</code> を実行した時、「Akashic Engine v3 is in beta」などの警告が誤って表示されます。 これは内部の仕様変更に起因するもので、出力される zip ファイルに問題はありません。</p><p>この不具合は、 akashic-cli@2.14.0 で修正済みです。</p><h3 id="wrong-is-atsumaru" tabindex="-1">akashic init の生成するテンプレートの isAtsumaru 変数の値が誤っている不具合の修正 <a class="header-anchor" href="#wrong-is-atsumaru" aria-label="Permalink to &quot;akashic init の生成するテンプレートの isAtsumaru 変数の値が誤っている不具合の修正 {#wrong-is-atsumaru}&quot;">​</a></h3><p>akashic-cli@2.12.0 以前の <code>akashic init</code> で、以下のテンプレートに含まれるコードが誤っていました。</p><ul><li><code>typescript-shin-ichiba-ranking</code></li><li><code>javascript-shin-ichiba-ranking</code></li></ul><p>このテンプレートの main.js 中の変数 <code>param.isAtsumaru</code> は、ゲーム実行時の環境がゲームアツマールかどうかを表すものです。 ゲームアツマールのマルチプレイで起動された時、この値が誤って偽になっていました。</p><p>この不具合は、 akashic-cli@2.12.1 で修正済みです。</p><h3 id="wrong-silence" tabindex="-1">シーンをまたいで BGM を再生した場合 BGM が止まってしまうことがある不具合の修正 <a class="header-anchor" href="#wrong-silence" aria-label="Permalink to &quot;シーンをまたいで BGM を再生した場合 BGM が止まってしまうことがある不具合の修正 {#wrong-silence}&quot;">​</a></h3><p>以下のような手順で Akashic コンテンツを実行させると、 (4) の後に BGM の再生が止まってしまう問題がありました。</p><ol><li>music のオーディオアセット(BGM)である A をロードするシーンに遷移する</li><li>A を 再生する</li><li>A をロードしないシーンに遷移する</li><li>A をロードするシーンに遷移する</li></ol><p>Akashic Engine において music のアセットは、シーンが変わっても他の music が再生されるまで再生され続けます。 そのため上の手順では (2) 以降ずっと再生され続けるべきですが、 (4) の後に再生が止まっていました。</p><p>この不具合は、 akashic-engine@3.2.1 で修正済みです。</p><h3 id="other-fixes" tabindex="-1">その他不具合の修正 <a class="header-anchor" href="#other-fixes" aria-label="Permalink to &quot;その他不具合の修正 {#other-fixes}&quot;">​</a></h3><ul><li>リプレイ再生時、無駄なティック取得を行う場合がある問題を修正</li><li>akashic-cli-serve で「Save playlog」ボタン(旧「今までのプレイ情報を保存」ボタン)を押した時ゲーム進行が止まる不具合の修正</li><li>akashic-cli-serve で --debug-playlog を指定するとゲームが動かない問題を修正</li><li>akashic-cli-serve で --debug-playlog に絶対パスを指定できなかった問題を修正</li></ul>',45);function c(g,d,o,y,u,m){const i=l("PlaygroundElement");return e(),t("div",null,[r,h(i,{gameJsonUri:"https://akashic-contents.github.io/website-contents/demo/basics/svg-sample/game.json",width:600,height:400}),E])}const A=n(k,[["render",c]]);export{v as __pageData,A as default};
