import{_ as t,o as e,c as s,Q as l}from"./chunks/framework.f1c0562b.js";const x=JSON.parse('{"title":"akashic serve","description":"","frontmatter":{},"headers":[],"relativePath":"reference/tool/akashic-cli/serve.md","filePath":"reference/tool/akashic-cli/serve.md"}'),n={name:"reference/tool/akashic-cli/serve.md"},a=l('<h1 id="akashic-serve" tabindex="-1">akashic serve <a class="header-anchor" href="#akashic-serve" aria-label="Permalink to &quot;akashic serve&quot;">​</a></h1><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">akashic</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">serve</span><span style="color:#E1E4E8;"> [&lt;options&gt;] [</span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">path</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;">]</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">akashic</span><span style="color:#24292E;"> </span><span style="color:#032F62;">serve</span><span style="color:#24292E;"> [&lt;options&gt;] [</span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">path</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;">]</span></span></code></pre></div><p><code>&lt;path&gt;</code> ディレクトリ(省略時はカレントディレクトリ)にあるゲームをホストする、マルチプレイ動作確認用サーバを起動します。</p><p>起動後に表示される URL(デフォルトでは <code>http://localhost:3300/</code>)を Web ブラウザで開いてください。</p><p><code>&lt;options&gt;</code> に指定可能なオプションは次のとおりです。</p><table><thead><tr><th style="text-align:center;">オプション</th><th style="text-align:center;">短縮名</th><th style="text-align:center;">効果</th><th style="text-align:center;">デフォルト値</th></tr></thead><tbody><tr><td style="text-align:center;"><code>--hostname &lt;hostname&gt;</code></td><td style="text-align:center;"><code>-H</code></td><td style="text-align:center;">起動するサーバのホスト名を指定します。</td><td style="text-align:center;"><code>localhost</code></td></tr><tr><td style="text-align:center;"><code>--port &lt;port&gt;</code></td><td style="text-align:center;"><code>-p</code></td><td style="text-align:center;">起動するサーバのポート番号を指定します。</td><td style="text-align:center;"><code>3300</code></td></tr><tr><td style="text-align:center;"><code>--verbose</code></td><td style="text-align:center;"><code>-v</code></td><td style="text-align:center;">詳細情報をログ出力します。</td><td style="text-align:center;"><code>false</code></td></tr><tr><td style="text-align:center;"><code>--no-auto-start</code></td><td style="text-align:center;"><code>-A</code></td><td style="text-align:center;">ブラウザ画面を開いた時、コンテンツに引数を渡す起動画面を表示します。</td><td style="text-align:center;">指定なし</td></tr><tr><td style="text-align:center;"><code>--target-service &lt;name&gt;</code></td><td style="text-align:center;"><code>-s</code></td><td style="text-align:center;">指定されたサービスの挙動を模擬します。(後述)</td><td style="text-align:center;"><code>none</code></td></tr><tr><td style="text-align:center;"><code>--watch</code></td><td style="text-align:center;"><code>-w</code></td><td style="text-align:center;">アセットディレクトリを監視し、変更時に新規プレイを作成します。</td><td style="text-align:center;">指定なし</td></tr><tr><td style="text-align:center;"><code>--server-external-script &lt;filepath&gt;</code></td><td style="text-align:center;">N/A</td><td style="text-align:center;">指定ファイルの js を評価し、アクティブインスタンスの g.game.external に代入します。</td><td style="text-align:center;">指定なし</td></tr><tr><td style="text-align:center;"><code>--debug-playlog &lt;path&gt;</code></td><td style="text-align:center;">N/A</td><td style="text-align:center;">指定した playlog.json を読み込みます(エンジン開発用、または開発中のオプションです)。</td><td style="text-align:center;">指定なし</td></tr><tr><td style="text-align:center;"><code>--allow-external</code></td><td style="text-align:center;">N/A</td><td style="text-align:center;">sandbox.config.js からの外部アクセスを許可する URL を読み込みます。</td><td style="text-align:center;">指定なし</td></tr><tr><td style="text-align:center;"><code>--no-open-browser</code></td><td style="text-align:center;">N/A</td><td style="text-align:center;">起動時にブラウザを開かないようにします。</td><td style="text-align:center;">指定なし</td></tr><tr><td style="text-align:center;"><code>--preserve-disconnected</code></td><td style="text-align:center;">N/A</td><td style="text-align:center;">サーバとの切断時に子ウィンドウを閉じないようにします。</td><td style="text-align:center;">指定なし</td></tr><tr><td style="text-align:center;"><code>--experimental-open &lt;num&gt;</code></td><td style="text-align:center;">N/A</td><td style="text-align:center;">指定数の子ウィンドウを開いて起動します。</td><td style="text-align:center;">指定なし</td></tr><tr><td style="text-align:center;"><code>--ssl-cert &lt;certificatePath&gt;</code></td><td style="text-align:center;">N/A</td><td style="text-align:center;">HTTPS で起動するための SSL 証明書のパスを指定します。</td><td style="text-align:center;">指定なし</td></tr><tr><td style="text-align:center;"><code>--ssl-key &lt;privatekeyPath&gt;</code></td><td style="text-align:center;">N/A</td><td style="text-align:center;">HTTPS で起動するための 秘密鍵のパスを指定します。</td><td style="text-align:center;">指定なし</td></tr><tr><td style="text-align:center;"><code>--cors-allow-origin &lt;origin&gt;</code></td><td style="text-align:center;">N/A</td><td style="text-align:center;">Access-Control-Allow-Origin レスポンスヘッダーの値を指定します。</td><td style="text-align:center;">指定なし</td></tr></tbody></table><p>ネットワークごしに(他の PC などから)マルチプレイを行いたい場合は、 <code>--hostname</code> に外部からアクセス可能なホスト名(IP アドレスなど)を指定してください。</p><p>オプション <code>--target-service</code> には下記の値を指定できます。</p><ul><li><code>nicolive</code>: ニコニコ生放送</li><li><code>none</code>: なし (デフォルト値)</li></ul><p><code>nicolive</code> が指定された場合、特定の条件で <code>JoinEvent</code> が自動的に送られるなど、ニコニコ生放送に近い次のような挙動で動作します。</p><ul><li>放送者役をいちいち Join させなくてもいいように <ul><li>起動後、最初に開かれたブラウザウィンドウのプレイヤーを必ず Join させる</li><li>「新規プレイ」ボタンでゲームを始める時も、このブラウザウィンドウのプレイヤーを Join させる</li><li>「Join Me」ボタンが無効になる</li></ul></li><li>コンテンツ起動時に与えられる引数を、ニコニコ生放送と同様のものに <ul><li>詳細割愛 (通常、ゲーム開発者がこの値を参照する必要はありません)</li></ul></li></ul><p>HTTPS で起動する場合は、<code>--ssl-cert</code> と <code>--ssl-key</code> オプションを指定してください。 自己証明書による起動もできますが、OS やブラウザにより証明書を登録する必要などがあり得ます。</p><p>また、自己証明書での起動では、<code>node-fetch</code> で自己証明書によるエラーが出ますので、下記のように証明書エラーを無視する環境変数を設定して serve を起動する必要があります。</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">env</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">NODE_TLS_REJECT_UNAUTHORIZED=</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">akashic</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">serve</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">.</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--ssl-cert</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">certificatePat</span><span style="color:#E1E4E8;">h</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--ssl-key</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">privatekeyPat</span><span style="color:#E1E4E8;">h</span><span style="color:#F97583;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">env</span><span style="color:#24292E;"> </span><span style="color:#032F62;">NODE_TLS_REJECT_UNAUTHORIZED=</span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">akashic</span><span style="color:#24292E;"> </span><span style="color:#032F62;">serve</span><span style="color:#24292E;"> </span><span style="color:#032F62;">.</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--ssl-cert</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">certificatePat</span><span style="color:#24292E;">h</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--ssl-key</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">privatekeyPat</span><span style="color:#24292E;">h</span><span style="color:#D73A49;">&gt;</span></span></code></pre></div>',14),o=[a];function c(r,d,p,i,y,g){return e(),s("div",null,o)}const h=t(n,[["render",c]]);export{x as __pageData,h as default};
