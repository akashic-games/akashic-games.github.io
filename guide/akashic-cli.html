<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-162208211-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-162208211-1');
</script>

<meta charset="UTF-8">
<meta name="viewport"    content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no,viewport-fit=cover">
<meta name="description" content="Akashic EngineはJavaScriptで動作する、無償利用が可能なマルチプラットフォーム対応ゲーム開発エンジンです">
<meta name="theme-color" content="#0F1F26">
<title>akashic-cli 利用ガイド</title>
<link rel="icon"       href="/favicon.ico" type="image/vnd.microsoft.icon">
<link rel="stylesheet" href="/css/common.css?5ddd7a0">
<link rel="stylesheet" href="/css/header.css?5ddd7a0">
<link rel="stylesheet" href="/css/footer.css?5ddd7a0">


<link rel="stylesheet" href="/css/asset.css?5ddd7a0">

<link rel="stylesheet" href="/css/akashic-document.css?5ddd7a0">

<link rel="stylesheet" href="/css/railscasts.css?5ddd7a0">


<script src="/lib/jquery-3.2.1.min.js"></script>
<script src="/lib/common.js?5ddd7a0"></script>


<script src="/lib/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</head>
<body>

<div class="head--spacer"></div>
<div class="SP--head--menu--show"></div>
<div class="SP--head--menu--hide"></div>

<div class="head--menu--outer">
	<ul class="head--menu">
		<li class="head--menu--item">
			<p class="head--menu--item--tab"></p>
			<ul class="head--menu--item--list">
				<li><a href="/tutorial/v3/">Akashic Engine入門</a></li>
				<li><a href="/shin-ichiba/">ニコ生ゲームを作ろう</a></li>
				<!--li><a href="/tutorial/akashic-info.html">Akashic Engine関連情報一覧</a></li-->
			</ul>
		</li>
		<li class="head--menu--item">
			<p class="head--menu--item--tab"></p>
			<ul class="head--menu--item--list">
				<li><a href="/guide/akashic-cli.html">akashic-cli利用ガイド</a></li>
				<li><a href="/guide/game-json.html">game.jsonの仕様</a></li>
				<li><a href="/guide/asset-recommended-spec.html">素材の推奨仕様</a></li>
				<li><a href="/guide/composite-operation.html">CompositeOperationの利用</a></li>
				<li><a href="/guide/storage.html">ストレージについて</a></li>
				<li><a href="/guide/asset-load-error.html">アセットロードエラーについて</a></li>
				<li><a href="/guide/atsumaru.html">RPGアツマール投稿ガイド</a></li>
				<li><a href="/guide/template-guide.html">akashic initテンプレート利用ガイド</a></li>
				<li><a href="/guide/shader.html">シェーダの利用</a></li>
				<li><a href="/guide/shin-ichiba/index.html">ニコニコ生放送で遊べるゲームの作成</a></li>
				<li><a href="/guide/sandbox-config.html">sandbox.config.jsの仕様</a></li>
				<li><a href="/guide/bmpfont-generator.html">bmpfont-generator の仕様</a></li>
				<li><a href="/guide/common-pitfalls.html">よくある落とし穴</a></li>
			</ul>
		</li>
		<li class="head--menu--item"><a class="head--logo" href="/" title="ホーム"></a></li>
		<li class="head--menu--item">
			<p class="head--menu--item--tab"></p>
			<ul class="head--menu--item--list">
				<li><a href="/reference/akashic-engine-v3/globals.html">akashic-engine v3.x</a></li>
				<li><a href="/reference/akashic-timeline/">akashic-timeline</a></li>
				<li><a href="/reference/akashic-animation/">akashic-animation</a></li>
				<li><a href="/reference/akashic-label/">akashic-label</a></li>
				<li><a href="/reference/akashic-tile/">akashic-tile</a></li>
				<li><a href="/reference/akashic-box2d/">akashic-box2d</a></li>
				<li><a href="/reference/coe/">coe framework</a></li>
				<li><a href="/reference/raycaster-js/">raycaster-js</a></li>
				<li><a href="/reference/collision-js/">collision-js</a></li>
				<li><a href="/reference/akashic-engine-v2/modules/_lib_main_d_.g.html">akashic-engine v2.x (旧版)</a></li>
				<li><a href="/reference/akashic-engine-v1/modules/_lib_main_d_.g.html">akashic-engine v1.x (旧版)</a></li>
			</ul>
		</li>
		<li class="head--menu--item">
			<p class="head--menu--item--tab"></p>
			<ul class="head--menu--item--list">
				<li><a href="/demo/?title=helloworld">Hello World</a></li>
				<li><a href="/demo/?title=scale-rotate-opacity">拡縮・回転・透明度</a></li>
				<li><a href="/demo/?title=bitmap-font">ビットマップフォント</a></li>
				<li><a href="/demo/?title=framesprite">フレームアニメーション</a></li>
				<li><a href="/demo/?title=demo-touchevent">タッチイベント</a></li>
				<li><a href="/demo/?title=demo-tile">タイル</a></li>
				<li><a href="/demo/?title=label-sample">ラベル</a></li>
				<li><a href="/demo/?title=animation-showcase">アニメーション制御</a></li>
				<li><a href="/demo/?title=timeline-sample">トゥイーン制御</a></li>
				<li><a href="/demo/?title=simpleShot">アブストラクトシューティング</a></li>
				<li><a href="/demo/?title=HoppingWitch">HOPPING WITCH</a></li>
				<li><a href="/demo/?title=GalaxyWars">GALAXY WARS</a></li>
				<li><a href="/demo/?title=cannontv">いくぜ！ 超会議</a></li>
				<li><a href="/asset/material.html">サンプルデモの素材</a></li>
			</ul>
		</li>
	</ul>
</div>

<header id="akashic-page-header">
	<div class="SP--head--logo--box"><a class="head--logo" href="/" title="ホーム"></a></div>
</header>

<div id="BodyInner">
	<section class="akashic--document safearea--LR">
		<div class="inner responsive--width">
			<h1>akashic-cli 利用ガイド</h1>
<h2><a name="これは"></a> これは</h2>
<p>Akashic でのゲーム開発を補助するコマンドラインツール、akashic コマンドの仕様と利用法を解説します。
akashic コマンドは akashic-cli をインストールして使用することができます。この利用ガイドで解説する akashic-cli の対象バージョンは 1.0.8 以降です。</p>
<p>斜体は検討中の箇所です。</p>
<h2><a name="インストール方法"></a> インストール方法</h2>
<p>akashic コマンド は、Node.js 環境で動作します。各プラットフォームで、適当な方法で Node.js をインストールしてください。この利用ガイドでは、 LTS 版の Node.js 環境を前提に説明を進めます。執筆時点での LTS 版のバージョンは 8.11.3 です。</p>
<p>Windows や Mac のユーザであれば、<a href="https://nodejs.org/download/">Node.js の公式 Web サイト</a> から適切なパッケージをダウンロードし、インストールすることができます。</p>
<pre><code class="language-sh">npm install -g @akashic/akashic-cli</code></pre>
<h2><a name="使い方"></a> 使い方</h2>
<p>無事にインストールができていれば、以下のコマンドが実行できるようになっています。実行すると、akashic コマンドの簡単なヘルプが表示されます。</p>
<pre><code class="language-sh">$ akashic</code></pre>
<p><code>akashic</code> は以下のコマンドを持ちます。</p>
<ul>
<li>akashic init<ul>
<li>Akashic のゲームとして最低限動作するスクリプトやディレクトリを生成します。</li>
</ul>
</li>
<li>akashic modify<ul>
<li>game.json に記述されている、ゲームの各種メタ情報を更新します。</li>
</ul>
</li>
<li>akashic scan<ul>
<li>game.json に記述されている、ゲームのアセットや各種ライブラリ情報を更新します。</li>
</ul>
</li>
<li>akashic serve<ul>
<li>Akashic のゲームをホストするマルチプレイ動作確認用サーバを起動します。</li>
</ul>
</li>
<li>akashic install<ul>
<li>npm install を行い、追加されたファイルのリストを game.json に加えます。</li>
</ul>
</li>
<li>akashic uninstall<ul>
<li>npm uninstall を行い、削除されたファイルを game.json のリストから取り除きます。</li>
</ul>
</li>
<li>akashic update<ul>
<li>npm update を行い、 <code>node_modules/</code> 以下の npm パッケージを更新し、ファイルに変更があれば game.json に加えます。</li>
</ul>
</li>
<li>akashic export zip<ul>
<li>ゲームを zip 形式に変換して出力します。</li>
</ul>
</li>
<li>akashic export html<ul>
<li>ゲームを単独で実行可能な HTML ファイル(と画像など)を含むディレクトリを生成します。</li>
</ul>
</li>
<li>akashic stat<ul>
<li>ゲームに関する情報を収集して出力します。</li>
</ul>
</li>
</ul>
<p>init 以外のコマンドは、init によって生成される game.json を操作・出力・実行します。したがって通常、ゲーム開発時にはまず akashic init を実行し、その後必要に応じて他コマンドを実行することになります。</p>
<h2><a name="init"></a> init</h2>
<pre><code class="language-sh">akashic init [&lt;options&gt;]</code></pre>
<p>新しく Akashic で動作するゲームをカレントディレクトリに生成します。</p>
<p>このコマンドを実行すると、以下のような対話型のインターフェースが表示され、ゲーム画面の幅・高さおよびゲームの FPS を入力できます。</p>
<pre><code class="language-sh">$ npm install -g @akashic/akashic-cli
$ cd GAME_HOME
$ akashic init
width: (320)
height: (320)
fps: (30)</code></pre>
<p>また、本コマンドは、カレントディレクトリが空でない場合、エラーで失敗することがあります。
(生成されるファイル・ディレクトリが既に存在する場合、エラーでコマンドが失敗します)。</p>
<p><code>&lt;options&gt;</code>に指定可能なオプションは次のとおりです。</p>
<table>
<thead>
<tr>
<th align="center">オプション</th>
<th align="center">短縮名</th>
<th align="center">効果</th>
<th align="center">デフォルト値</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>--type &lt;type&gt;</code></td>
<td align="center"><code>-t</code></td>
<td align="center"><code>&lt;type&gt;</code> の値に応じたゲームが作成されます。詳細については後述します。</td>
<td align="center"><code>javascript</code></td>
</tr>
<tr>
<td align="center"><code>--force</code></td>
<td align="center"><code>-f</code></td>
<td align="center">生成されるファイル・ディレクトリが既に存在する場合でも、エラーにせず上書きします。</td>
<td align="center"><code>false</code></td>
</tr>
<tr>
<td align="center"><code>--yes</code></td>
<td align="center"><code>-y</code></td>
<td align="center">対話型インターフェースを表示せずに、デフォルトの設定でゲームを生成します。</td>
<td align="center"><code>false</code></td>
</tr>
</tbody></table>
<h3><a name="--typeオプション"></a> --type オプション</h3>
<p>&lt;type&gt; に指定できる値は、 以下の通りです。指定しない場合、 <code>javascript</code> が指定されたものとして扱われます。</p>
<ul>
<li><code>javascript</code></li>
<li><code>javascript-minimal</code></li>
<li><code>javascript-shin-ichiba-ranking</code></li>
<li><code>typescript</code></li>
<li><code>typescript-minimal</code></li>
<li><code>typescript-shin-ichiba-ranking</code></li>
</ul>
<h4><a name="javascript"></a> javascript</h4>
<p>下記のディレクトリ・ファイルを含む JavaScript で書かれたゲームが生成されます。</p>
<pre><code>GAME_HOME
 +- image/
 +- text/
 +- audio/
 +- script/
  +- main.js
 +- game.json
 +- package.json</code></pre><p><code>script/main.js</code> を編集することでゲームの作成が可能です。
これらのディレクトリ・ファイルの詳細は  <a href="#init%E3%81%A7%E4%BD%9C%E3%82%89%E3%82%8C%E3%82%8B%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB">init で作られるファイル</a>  の節を参照してください。
このゲームではサンプルとして以下のような処理が行われています。</p>
<ul>
<li>スプライトの表示</li>
<li>音を鳴らす</li>
<li>タッチイベント定義</li>
</ul>
<h4><a name="javascript-minimal"></a> javascript-minimal</h4>
<p>最低限の処理しか記述されていない空のゲームが生成されます。
<code>script/main.js</code> を編集することでゲームの作成が可能です。</p>
<h4><a name="javascript-shin-ichiba-ranking"></a> javascript-shin-ichiba-ranking</h4>
<p>ニコ生ゲームのランキングに対応したゲームの雛形が生成されます。
<code>script/main.js</code> を編集することでゲームの作成が可能です。基本的に <code>script/_bootstrap.js</code> を編集する必要はありません。
このゲームでは、<code>script/main.js</code> の <code>main</code> 関数の引数 <code>param</code> に以下の値が新たに付与されています。</p>
<ul>
<li><code>param.sessionParameter</code>: <a href="/guide/shin-ichiba/shin-ichiba-spec#session-parameter">セッションパラメータ</a></li>
<li><code>param.isAtsumaru</code>:ゲームが動作している環境が RPG アツマール上かどうかを表す boolean 値</li>
</ul>
<p>ランキングモードに対応したニコ生ゲームの作り方については、<a href="/guide/shin-ichiba/ranking">こちら</a>を参照してください。</p>
<h4><a name="typescript"></a> typescript</h4>
<p>TypeScript で書かれたゲームと、ビルドに必要なディレクトリ・ファイルが生成されます。
これらをビルドすることで、game ディレクトリ以下に Akashic で動作するゲームを生成します。
ビルドの方法は、生成される README.md を参照してください。</p>
<p>ゲームの内容は、<code>--type javascript</code> を指定した場合に生成されるゲームと同一です。</p>
<h4><a name="typescript-minimal"></a> typescript-minimal</h4>
<p><code>--type tyepescript</code> と同様に、TypeScript で書かれたゲームと、ビルドに必要なディレクトリ・ファイルが生成されます。</p>
<p>ゲームの内容は、<code>--type javascript-minimal</code> を指定した場合に生成されるゲームと同一です。</p>
<h4><a name="typescript-shin-ichiba-ranking"></a> typescript-shin-ichiba-ranking</h4>
<p><code>--type tyepescript</code> と同様に、TypeScript で書かれたゲームと、ビルドに必要なディレクトリ・ファイルが生成されます。</p>
<p>ゲームの内容は、<code>--type javascript-shin-ichiba-ranking</code> を指定した場合に生成されるゲームと同一です。</p>
<h2><a name="modify"></a> modify</h2>
<pre><code class="language-sh">akashic modify &lt;target&gt;</code></pre>
<p>game.json に記述されている各種メタ情報を更新します。
&lt;target&gt; に指定できる文字列は以下のとおりです:</p>
<ul>
<li>width &lt;new_width&gt;<ul>
<li>game.json に記述されたゲーム画面の幅を &lt;new_width&gt; の値(数値)で更新します。</li>
</ul>
</li>
<li>height &lt;new_height&gt;<ul>
<li>game.json に記述されたゲーム画面の高さを &lt;new_height&gt; の値(数値)で更新します。</li>
</ul>
</li>
<li>fps &lt;new_fps&gt;<ul>
<li>game.json に記述されたゲーム画面の FPS を &lt;new_fps&gt; の値(数値)で更新します。</li>
</ul>
</li>
</ul>
<h2><a name="scan"></a> scan</h2>
<pre><code class="language-sh">akashic scan &lt;target&gt;</code></pre>
<p>game.json に記述されているゲームのアセットや各種ライブラリ情報を更新します。
&lt;target&gt; に指定できる文字列は以下のとおりです:</p>
<ul>
<li>asset &lt;subtarget&gt;<ul>
<li>game.json に記述されたアセット情報を更新します。(&lt;subtarget&gt; の内容は後述)</li>
</ul>
</li>
<li>globalScripts<ul>
<li>カレントディレクトリの node_modules/ 以下のファイル一覧を game.json に加えます。</li>
<li>通常使用する必要はありません。akashic install や uninstall を利用してください。</li>
</ul>
</li>
</ul>
<p>game.json のアセット情報を更新する scan asset コマンドは、もう一つの引数 &lt;subtarget&gt; によって更新する情報を制御することができます。</p>
<pre><code class="language-sh">akashic scan asset &lt;subtarget&gt;</code></pre>
<p>&lt;subtarget&gt; に指定できる文字列とそれぞれの動作は次のとおりです:</p>
<ul>
<li>image<ul>
<li>image/ ディレクトリ以下の画像素材を列挙し、アセット情報を更新します。</li>
</ul>
</li>
<li>text<ul>
<li>text/ ディレクトリ以下のテキスト素材を列挙し、アセット情報を更新します。</li>
</ul>
</li>
<li>audio<ul>
<li>audio/ ディレクトリ以下の音素材を列挙し、アセット情報を更新します。</li>
</ul>
</li>
<li>script<ul>
<li>script/ ディレクトリ以下のスクリプト素材を列挙し、アセット情報を更新します。</li>
</ul>
</li>
<li>(なし)<ul>
<li>上記すべてを行います。</li>
<li>さらに assets/ ディレクトリ以下の全種類の素材を列挙してアセット情報を更新します。</li>
</ul>
</li>
</ul>
<p>game.json の管理しているアセット情報には、ファイルパスだけでなく以下のような情報も含まれます。
したがって素材の増減時だけでなく、これらの変更時にも scan asset コマンドを実行してください。</p>
<ul>
<li>画像素材の幅・高さ</li>
<li>(将来のバージョンにおいて) 音素材の再生時間</li>
</ul>
<p>scan asset コマンドは、新たに追加するアセット定義に対し、type に応じて以下の初期値を与えます。
(値の詳細は<a href="game-json.html">game.json の仕様</a>を参照してください)</p>
<ul>
<li>&quot;type&quot;: &quot;script&quot;<ul>
<li>&quot;global&quot;: true</li>
</ul>
</li>
<li>&quot;type&quot;: &quot;audio&quot;<ul>
<li>&quot;systemId&quot;: &quot;sound&quot;</li>
</ul>
</li>
</ul>
<p>scan asset コマンドによる素材の列挙は、ディレクトリを再帰的に検索します。つまり、image/ のサブディレクトリに置かれた画像素材なども、列挙されアセット情報に登録されます。</p>
<h3>アセットID</h3>
<p>Akashic コンテンツから各アセットにアクセスするには、アセットを識別する ID (アセット ID) またはファイルパス (Akashic Engine v3 以降) を利用します。</p>
<p>scan asset コマンドは、アセット ID として通常「ファイル名から拡張子を取り除いたもの」を登録します。</p>
<blockquote>
<p>このため audio/title.ogg と script/title.js は、同じ &quot;title&quot; という ID となって衝突し、エラーになることに注意してください。
この制限を回避するため、 Akashic Engine v3 以降では assets/ ディレクトリ (後述) を利用できます。</p>
</blockquote>
<p>またアセットのファイル名は以下の条件を全て満たす必要があります。</p>
<ul>
<li>半角英数字、アンダースコア &quot;_&quot;、ドル記号 &quot;$&quot; のみで構成されている</li>
<li>英字で始まっている</li>
</ul>
<p>ユーザは game.json を直接編集して、アセット ID を任意に変更することができます。
akashic コマンドはファイルパスを基準に操作を行うため、たとえば画像素材の ID を変更した後にその画像のサイズを変更しても、適切に game.json の幅・高さ情報が更新されます。</p>
<h3>assets/ ディレクトリとアセットパス</h3>
<p>assets/ ディレクトリは、上述のとおり全ての種類の素材を置くことができるディレクトリです。</p>
<p>また scan asset コマンドは、assets/ ディレクトリに限り、アセット ID を「ファイル名から拡張子を取り除いたもの」ではなく、ユニークな自動生成の値にします。
そのため title.ogg と title.png など、名前が重複するアセットもそのまま置くことができます。</p>
<p>これによって他のディレクトリよりも柔軟なフォルダ構造で素材を管理できます。</p>
<p>ただし ID が自動生成で不定な値になるので、ゲーム内からアセット ID でアクセスすることはできなくなります。
Akashic Engine v3 以降で利用できる <a href="/tutorial/v3/assetPaths.html">ファイルパスによるアセットアクセス</a> を利用してください。</p>
<h2><a name="serve"></a> serve</h2>
<pre><code class="language-sh">akashic serve [&lt;options&gt;] [&lt;path&gt;]</code></pre>
<p><code>&lt;path&gt;</code> ディレクトリ(省略時はカレントディレクトリ)にあるゲームをホストする、マルチプレイ動作確認用サーバを起動します。</p>
<p>起動後に表示される URL(デフォルトでは <code>http://localhost:3300/</code>)を Web ブラウザで開いてください。</p>
<p><code>&lt;options&gt;</code> に指定可能なオプションは次のとおりです。</p>
<table>
<thead>
<tr>
<th align="center">オプション</th>
<th align="center">短縮名</th>
<th align="center">効果</th>
<th align="center">デフォルト値</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>--hostname &lt;hostname&gt;</code></td>
<td align="center"><code>-H</code></td>
<td align="center">起動するサーバのホスト名を指定します。</td>
<td align="center"><code>localhost</code></td>
</tr>
<tr>
<td align="center"><code>--port &lt;port&gt;</code></td>
<td align="center"><code>-p</code></td>
<td align="center">起動するサーバのポート番号を指定します。</td>
<td align="center"><code>3300</code></td>
</tr>
<tr>
<td align="center"><code>--target-service &lt;name&gt;</code></td>
<td align="center"><code>-s</code></td>
<td align="center">指定されたサービスの挙動を模擬します。(後述)</td>
<td align="center"><code>none</code></td>
</tr>
<tr>
<td align="center"><code>--verbose</code></td>
<td align="center"><code>-v</code></td>
<td align="center">詳細情報をログ出力します。</td>
<td align="center"><code>false</code></td>
</tr>
</tbody></table>
<p>ネットワークごしに(他の PC などから)マルチプレイを行いたい場合は、 <code>--hostname</code> に外部からアクセス可能なホスト名(IP アドレスなど)を指定してください。</p>
<p>オプション <code>--target-service</code> には <code>none</code> または <code>nicolive</code> を指定できます。
<code>nicolive</code> が指定された場合、特定の条件で <code>JoinEvent</code> が自動的に送られるなど、ニコニコ生放送に近い挙動で動作します。
詳細はニコ生ゲームのガイド文書 <a href="/guide/shin-ichiba/multi.html#debug">multi モードのゲーム作成</a> を参照してください。</p>
<h2><a name="install"></a> install</h2>
<pre><code class="language-sh">akashic install [&lt;module&gt;]</code></pre>
<p><code>npm install</code> のラッパーコマンドです。</p>
<p><code>&lt;module&gt;</code> を与えた場合、 <code>npm install --save &lt;module&gt;</code> を行い、また導入されたファイルの一覧を game.json に加えます。すなわち次のコマンドと概ね等価な振る舞いをします。</p>
<pre><code class="language-sh">npm install --save &lt;module&gt;
akashic scan globalScripts</code></pre>
<p>@akashic-extension/ で提供される Akashic 向けの拡張機能の他、任意の npm パッケージをゲームに導入することができます。</p>
<blockquote>
<p>注意: Akashic は Node.js のコアモジュール(<code>http</code>, <code>path</code> など)をサポートしていません。コアモジュールに依存しているパッケージを導入した場合、エラーメッセージが表示されます。この場合、<code>npm install</code> は行われ、game.json も更新されますが、ゲームとして実行しようとするとエラーになります。</p>
</blockquote>
<blockquote>
<p>またブラウザ固有の機能や、ECMAScript の一部機能 (<code>Math.random()</code> のような内部状態を持つ機能など) は、
Akashic のゲームとしてはサポートされていません。それらの機能を用いる npm パッケージを導入しないでください。
(akashic コマンド はこれにエラーを出すことはできません。)</p>
</blockquote>
<p>このコマンドは <code>npm install</code> を行うため、game.json と同じディレクトリに package.json という名前のファイルが存在する必要があります。事前に <code>npm init</code> を行うなどの方法で作成してください。
(<code>akashic init</code> が提供するビルトインのテンプレートには含まれています。)</p>
<p><code>&lt;module&gt;</code> を省略した場合、単に <code>npm install</code> を行います。
(package.json に依存生が記録されたパッケージが導入されます。)
game.json は更新されません。package-lock.json がない場合、利用しないでください。
(意図しないバージョンのパッケージが導入される可能性があります。)</p>
<h2><a name="uninstall"></a> uninstall</h2>
<pre><code class="language-sh">akashic uninstall &lt;module&gt;</code></pre>
<p><code>npm uninstall --save &lt;module&gt;</code> を行い、削除されたファイルを game.json から取り除きます。</p>
<p>(install コマンド同様、game.json と同じディレクトリに package.json という名前のファイルが存在する必要があります)</p>
<h2><a name="update"></a> update</h2>
<pre><code class="language-sh">akashic update &lt;module&gt;</code></pre>
<p><code>npm update &lt;module&gt;</code> を行い、./node_modules 以下の npm パッケージを更新します。ファイルの変更は game.json に反映されます。</p>
<p>(install コマンド同様、game.json と同じディレクトリに package.json という名前のファイルが存在する必要があります)</p>
<p><code>&lt;module&gt;</code> を指定しなかった場合、全ての npm パッケージを更新します。npm update の詳細は <a href="https://docs.npmjs.com/cli/update">npm のドキュメント</a> を参照してください。</p>
<h2><a name="export-zip"></a> export zip</h2>
<pre><code class="language-sh">akashic export zip [--output &lt;fileName&gt;]</code></pre>
<p>ゲームディレクトリを zip 形式で圧縮したファイルを <code>&lt;fileName&gt;</code> に出力します。
<code>--output</code> オプションが指定されなかった場合、 <code>./game.zip</code> が指定されたかのように振る舞います。存在するファイル名・ディレクトリ名を指定した場合、エラーになります。</p>
<h2><a name="export-html"></a> export html</h2>
<pre><code class="language-sh">akashic export html --output &lt;dirName&gt; [--bundle] [--minify] [--magnify] [--no-strip]</code></pre>
<p>単独でゲームを実行可能な HTML ファイル (と関連ファイル) を含むディレクトリを出力します。出力されたディレクトリの index.html を Web ブラウザで開くことで、 akashic-sandbox などの動作確認ツールなしにゲームを実行できます。</p>
<p>利用可能なオプションは次のとおりです:</p>
<table>
<thead>
<tr>
<th align="center">オプション</th>
<th align="center">効果</th>
<th align="center">デフォルト値</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>--output &lt;dirName&gt;</code></td>
<td align="center">出力するフォルダを <code>&lt;dirName&gt;</code> にする</td>
<td align="center">N/A</td>
</tr>
<tr>
<td align="center"><code>--bundle</code></td>
<td align="center">スクリプトアセットやテキストアセットなど、可能なものを index.html にまとめる</td>
<td align="center">指定なし</td>
</tr>
<tr>
<td align="center"><code>--minify</code></td>
<td align="center">スクリプトアセットを minify する</td>
<td align="center">指定なし</td>
</tr>
<tr>
<td align="center"><code>--magnify</code></td>
<td align="center">ゲーム画面をブラウザのウィンドウサイズに合わせて拡縮するようにする</td>
<td align="center">指定なし</td>
</tr>
<tr>
<td align="center"><code>--inject &lt;fileName&gt;</code></td>
<td align="center">出力 HTML の head 要素に <code>&lt;fileName&gt;</code> の内容を含める</td>
<td align="center">指定なし</td>
</tr>
<tr>
<td align="center"><code>--no-strip</code></td>
<td align="center">ゲーム実行に不要なファイルを出力から除外しない</td>
<td align="center">指定なし</td>
</tr>
</tbody></table>
<p><code>--inject</code> オプション(<code>akashic-cli@1.3.1</code> で導入)は複数指定可能です。指定した順でファイルの内容が出力されます。ディレクトリ名も指定でき、その場合はディレクトリ内の全ファイルが出力されます(順不同)。</p>
<p><code>--output</code> オプションに存在するファイル名・ディレクトリ名を指定した場合、エラーになります。またゲームのディレクトリ以下のパスを指定することはできません。たとえば game.json のあるディレクトリで次のように指定するとエラーになります。</p>
<pre><code class="language-sh">$ akashic export html --output ./bundled  # エラー</code></pre>
<p><code>./bundled</code> ではなく <code>../bundled</code> にするなど、ゲームのディレクトリの外を指定してください。この場合、 <code>../bundled/index.html</code> を Web ブラウザで開くと、単独でゲームを実行できます。
(ゲーム実行には <code>../bundled/</code> 以下のファイルがすべて必要である点に注意してください)</p>
<pre><code class="language-sh">$ akashic export html --output ../bundled</code></pre>
<h2><a name="stat"></a> stat</h2>
<pre><code class="language-sh">akashic stat &lt;target&gt; [options...]</code></pre>
<p><code>&lt;target&gt;</code> で指定された内容に関して情報を収集して出力します。現在 <code>&lt;target&gt;</code> に与えられるのは <code>size</code> のみです。</p>
<h3><a name="ゲームの容量計算 (size)"></a> ゲームの容量計算 (size)</h3>
<p><code>&lt;target&gt;</code> に <code>size</code> を指定すると、ゲームの容量を計算します。ゲームの容量とはゲームを配信する際にネットワーク通信が必要なコンテンツのファイルサイズの合計のことです。</p>
<p>何もオプションを付けずに実行した場合、以下のように表示されます。</p>
<pre><code class="language-sh">$ akashic stat size
image: 415.49KB (84%)
text: 25.60KB (5%)
ogg audio: 47.74KB
mp4 audio: 53.02KB (11%)
aac audio: 52.71KB
script: 641B (0%)
other: 1.44KB (0%)
  game.json: 1.44KB
[ ] TOTAL SIZE (using ogg): 490.90KB (502685B)
[*] TOTAL SIZE (using mp4): 496.19KB (508096B)
[ ] TOTAL SIZE (using aac): 495.87KB (507775B)</code></pre>
<p>オーディオは mp4 と aac と ogg のうち合計容量が大きいものを利用して計算します。結果表示の <code>(87%)</code> の部分は全体用量に占めるそのカテゴリのファイルの割合を示しています。
<code>game.json</code>, <code>node_moduels/</code> 以下のスクリプトは <code>other</code> に分類されます。</p>
<p><code>--limit</code> オプションが指定されると、ゲームの容量が指定された値を超えた場合にエラーと表示され、コマンド自体の戻り値が正常終了時の <code>0</code> ではなく <code>1</code> になります。</p>
<p>容量は <code>--limit 100KB</code> のように指定します。<code>1KB</code> は <code>1024B</code> として計算されます。単位として、<code>B</code>, <code>KB</code>, <code>MB</code>, <code>GB</code> が利用でき、末尾の <code>B</code> は省略できます。</p>
<p><code>--raw</code> オプションが指定されると、以下のように合計容量のバイト数のみを表示して終了します。</p>
<pre><code class="language-sh">$ akashic stat size --raw
1657274</code></pre>
<h2><a name="initで作られるファイル"></a> init で作られるファイル</h2>
<h3><a name="imageディレクトリ"></a> image ディレクトリ</h3>
<p>画像素材を配置するディレクトリ。</p>
<p>サポートされる拡張子は png/jpg であり、拡張子と画像フォーマットは一致している必要があります。それ以外の拡張子のファイル、または &quot;.&quot; から始まるファイルは無視されます。</p>
<h3><a name="textディレクトリ"></a> text ディレクトリ</h3>
<p>テキスト素材を配置するディレクトリ。</p>
<p>サポートされる拡張子は特に指定がないため、 &quot;.&quot; から始まるファイル以外はすべて取り込まれます。
<em>取り込まれないファイルを指定する方法は検討中。</em></p>
<h3><a name="audioディレクトリ"></a> audio ディレクトリ</h3>
<p>音楽、効果音など、音素材を配置するディレクトリ。</p>
<p>サポートされる拡張子は ogg と aac であり、拡張子とファイルフォーマットは一致している必要があります。それ以外の拡張子のファイル、または &quot;.&quot; から始まるファイルは無視されます。</p>
<p>他の素材と異なり、音素材は、ファイル名の拡張子部分のみが異なる複数のファイルをまとめて取り扱います。それら (audio/foo.ogg と audio/foo.aac など) は同一の内容であることが期待されます。これはゲームの実行環境に応じて適切な形式を選択し利用するためです。</p>
<h3><a name="scriptディレクトリ"></a> script ディレクトリ</h3>
<p>スクリプト素材を配置するディレクトリ。</p>
<p>サポートされる拡張子は.js と.json であり、拡張子とファイルフォーマットは一致している必要があります。それ以外の拡張子のファイル、または &quot;.&quot; から始まるファイルは無視されます。</p>
<p>慣習として、各 Scene を実装するファイルは、このディレクトリ内に
&quot;Scene.js&quot; という接尾辞をつけて配置される事が推奨されます（例: titleScene.js, battleScene.js）。</p>
<h3><a name="main.js"></a> main.js ファイル</h3>
<p>ゲームの処理が記述されているファイル。</p>
<p>このファイルを編集することによってゲームを作成することが可能です。</p>
<h3><a name="_bootstrap.js"></a> _bootstrap.js ファイル</h3>
<p><code>--type javascript-shin-ichiba-ranking</code> を指定した時(もしくは <code>--type typescript-shin-ichiba-ranking</code> を指定後ビルドした時)のみ作られるファイルです。
このファイルがエントリーポイントとなりますが、ゲーム開発者がこのファイルを編集することは基本的にありません。
ここで行っていることは、以下の通りです。</p>
<ul>
<li>セッションパラメータの取得</li>
<li>ゲームが動作している環境が RPG アツマール上かどうかの判定</li>
<li>main.js に自動的に遷移</li>
</ul>
<h3><a name="game.jsonファイル"></a> game.json ファイル</h3>
<p>ゲームの各種情報を記述するファイル。</p>
<p><code>akashic init --type javascript-minimal</code> を実行した直後は以下のような内容になっています。
(ただし width, height, fps は init で指定した値)</p>
<pre><code class="language-json">{
  &quot;width&quot;: 480,
  &quot;height&quot;: 480,
  &quot;fps&quot;: 30,
  &quot;assets&quot;: {
    &quot;mainScene&quot;: {
      &quot;type&quot;: &quot;script&quot;,
      &quot;path&quot;: &quot;script/main.js&quot;,
      &quot;global&quot;: true
    }
  }
}</code></pre>
<p>詳細な仕様は<a href="game-json.html">game.json の仕様</a>を参照してください。</p>
<h2><a name="Node.js 開発者向けの追加情報"></a> Node.js 開発者向けの追加情報</h2>
<p>akashic は、install, uninstall コマンドを除き、package.json に関知しません。</p>
<p>ゲーム開発者は、npm install --save-dev jasmine して spec ディレクトリにテストを配置するなど、任意の開発フローを(Akashic のディレクトリ構成と衝突するなどの問題がない限り)とることができます。</p>

		</div>
	</section>
	<footer class="safearea--LR">
	<div class="responsive--width">

		<ul class="foot--creativecommons">
			<li class="foot--creativecommons--ban"><a href="http://creativecommons.org/licenses/by/2.1/jp/" target="_blank"><img alt="クリエイティブ・コモンズ・ライセンス" src="https://i.creativecommons.org/l/by/2.1/jp/80x15.png"></a></li>
			<li class="foot--creativecommons--txt">このサイトの画像は、一部を除き <a rel="license" href="http://creativecommons.org/licenses/by/2.1/jp/" target="_blank">クリエイティブ・コモンズ 表示 2.1 日本 ライセンス</a><br>の下に提供されています: <a href="/image-license.html">詳細</a></li>
		</ul>

		<ul class="foot--license">
			<li class="foot--license--akashic"><a href="https://akashic-games.github.io"></a></li>
			<li class="foot--license--dwango"><a href="http://dwango.co.jp" target="_blank">&copy; dwango</a></li>
		</ul>

	</div>
</footer>

</div>
<div class="page--top"></div>
<div class="window--dark"></div>

<script>
	// リサイズ時にコンテンツのリサイズができない状態なので暫定対応でコンテンツをリロードしている
	// TODO: リサイズ時にコンテンツも追従する仕組みを作成する
	window.addEventListener('resize', function() {
		var iframes = document.getElementsByClassName('akashic-content');
		var contents = Array.prototype.slice.call(iframes);
		contents.forEach(function(content) {
			content.contentWindow.location.reload(true);
		});
	});
</script>
</body>
</html>
